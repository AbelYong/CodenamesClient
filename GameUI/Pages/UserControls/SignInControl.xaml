<UserControl x:Class="CodenamesClient.GameUI.Pages.UserControls.SignInControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:CodenamesClient.GameUI.Pages.UserControls"
             xmlns:viewmodels="clr-namespace:CodenamesClient.GameUI.ViewModels"
             d:DataContext="{d:DesignInstance Type=viewmodels:SignInViewModel}"
             xmlns:language="clr-namespace:CodenamesClient.Properties.Langs"
             mc:Ignorable="d" 
             d:DesignHeight="720" d:DesignWidth="500" Background="#FF1D1D1D">

    <UserControl.Resources>
        <ControlTemplate x:Key="BelowTextValidationTemplate">
            <DockPanel LastChildFill="True">
                <TextBlock Margin="0,4,0,0" Foreground="Tomato" FontSize="12" TextWrapping="Wrap" DockPanel.Dock="Bottom"
                           Text="{Binding ElementName=adorner, Path=AdornedElement.(Validation.Errors)[0].ErrorContent}"/>
                <AdornedElementPlaceholder x:Name="adorner"/>
            </DockPanel>
        </ControlTemplate>

        <Style x:Key="ValidatedTextBox" TargetType="TextBox" BasedOn="{StaticResource textBoxCustomFocus}">
            <Setter Property="Validation.ErrorTemplate" Value="{StaticResource BelowTextValidationTemplate}"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="Width" Value="360"/>
            <Style.Triggers>
                <Trigger Property="Validation.HasError" Value="True">
                    <Setter Property="BorderBrush" Value="Tomato"/>
                    <Setter Property="ToolTip" Value="{Binding (Validation.Errors)[0].ErrorContent, RelativeSource={RelativeSource Self}}"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="ChecklistItemStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="Tomato"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Margin" Value="0,2,0,0"/>
            <Setter Property="TextWrapping" Value="Wrap"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=Tag}" Value="True">
                    <Setter Property="Foreground" Value="LimeGreen"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <Storyboard x:Key="SlideInMainAnimation">
            <DoubleAnimation Storyboard.TargetName="MainRegisterGrid"
                             Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.Y)"
                             From="720" To="0" Duration="0:0:0.3">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>

        <Storyboard x:Key="SlideOutMainAnimation">
            <DoubleAnimation Storyboard.TargetName="MainRegisterGrid"
                             Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.Y)"
                             From="0" To="720" Duration="0:0:0.3">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseIn"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>

        <Storyboard x:Key="SlideInVerifyAnimation">
            <DoubleAnimation Storyboard.TargetName="VerifyGrid" Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.Y)" From="800" To="0" Duration="0:0:0.2">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
        <Storyboard x:Key="SlideOutVerifyAnimation">
            <DoubleAnimation Storyboard.TargetName="VerifyGrid" Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.Y)" From="0" To="800" Duration="0:0:0.2">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseIn"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
    </UserControl.Resources>

    <Grid>
        <Grid x:Name="MainRegisterGrid" VerticalAlignment="Center" HorizontalAlignment="Center" Width="520">
            <Grid.RenderTransform>
                <TranslateTransform Y="720"/>
            </Grid.RenderTransform>

            <StackPanel>
                <Label Content="{x:Static language:Lang.loginSignIn}" Style="{StaticResource subtitle}" Margin="0,0,0,8"/>
                <Label Content="{x:Static language:Lang.profileEmail}" Style="{StaticResource normal}" />
                <Grid HorizontalAlignment="Center" Width="360">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBox Style="{StaticResource ValidatedTextBox}" Text="{Binding Email, UpdateSourceTrigger=LostFocus, ValidatesOnNotifyDataErrors=True, NotifyOnValidationError=True}"/>
                    <Border Grid.Column="1" Margin="10,0,-40,0" Background="#444" CornerRadius="15" Width="30" Height="30" Cursor="Hand" BorderBrush="Gray" BorderThickness="1" ToolTipService.InitialShowDelay="0" ToolTipService.ShowDuration="10000">
                        <TextBlock Text="?" HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="White" FontWeight="Bold" FontSize="18"/>
                        <Border.ToolTip>
                            <ToolTip Background="#222" BorderBrush="Gray" HasDropShadow="True">
                                <StackPanel Margin="5">
                                    <TextBlock Text="{x:Static language:Lang.signInAcceptedEmailDomains}" FontWeight="Bold" Foreground="White" Margin="0,0,0,5"/>
                                    <TextBlock Text="{x:Static language:Lang.emailGmailDomain}"/>
                                    <TextBlock Text="{x:Static language:Lang.emailOutlookDomain}"/>
                                    <TextBlock Text="{x:Static language:Lang.emailEstudiantesUvMxDomain}"/>
                                </StackPanel>
                            </ToolTip>
                        </Border.ToolTip>
                    </Border>
                </Grid>
                <Label Content="{x:Static language:Lang.globalUsername}" Style="{StaticResource normal}" Margin="0,16,0,0"/>
                <TextBox Style="{StaticResource ValidatedTextBox}" Text="{Binding Username, UpdateSourceTrigger=LostFocus, ValidatesOnNotifyDataErrors=True, NotifyOnValidationError=True}"/>

                <Label Content="{x:Static language:Lang.loginPassword}" Style="{StaticResource normal}" Margin="0,16,0,0"/>

                <Grid HorizontalAlignment="Center" Width="360">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <TextBox Grid.Column="0" x:Name="PasswordInput" Style="{StaticResource ValidatedTextBox}"
                             Text="{Binding Password, UpdateSourceTrigger=PropertyChanged, ValidatesOnNotifyDataErrors=True}" 
                             FontSize="16" LostFocus="PasswordInput_LostFocus"/>

                    <Border Grid.Column="1" Margin="10,0,-40,0" Background="#444" CornerRadius="15" Width="30" Height="30" 
                            Cursor="Hand" BorderBrush="Gray" BorderThickness="1" ToolTipService.InitialShowDelay="0"
                            ToolTipService.ShowDuration="10000">
                        <TextBlock Text="?" HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="White" FontWeight="Bold" FontSize="18"/>
                        <Border.ToolTip>
                            <ToolTip Background="#222" BorderBrush="Gray" HasDropShadow="True">
                                <StackPanel Margin="5">
                                    <TextBlock Text="{x:Static language:Lang.signInPasswordRequirements}" FontWeight="Bold" Foreground="White" Margin="0,0,0,5"/>
                                    <TextBlock Style="{StaticResource ChecklistItemStyle}" Tag="{Binding PwHasMinLength}" Text="{Binding PwMinLengthText}"/>
                                    <TextBlock Style="{StaticResource ChecklistItemStyle}" Tag="{Binding PwWithinMaxLength}" Text="{Binding PwMaxLengthText}"/>
                                    <TextBlock Style="{StaticResource ChecklistItemStyle}" Tag="{Binding PwHasUpper}" Text="{x:Static language:Lang.signInPasswordAtLeastOneUppercaseLetter}"/>
                                    <TextBlock Style="{StaticResource ChecklistItemStyle}" Tag="{Binding PwHasLower}" Text="{x:Static language:Lang.signInPasswordAtLeastOneLowercaseLetter}"/>
                                    <TextBlock Style="{StaticResource ChecklistItemStyle}" Tag="{Binding PwHasDigit}" Text="{x:Static language:Lang.signInPasswordAtLeastOneDigit}"/>
                                    <TextBlock Style="{StaticResource ChecklistItemStyle}" Tag="{Binding PwHasSpecial}" Text="{x:Static language:Lang.signInPasswordAtLeastOneSpecialCharacter}"/>
                                    <TextBlock Style="{StaticResource ChecklistItemStyle}" Tag="{Binding PwNoConsecutiveRun}" Text="{x:Static language:Lang.signInPasswordNotContainMoreThan3ConsecutiveDigits}"/>
                                </StackPanel>
                            </ToolTip>
                        </Border.ToolTip>
                    </Border>
                </Grid>

                <Label Content="{x:Static language:Lang.signInConfirmPassword}" Style="{StaticResource normal}" Margin="0,8,0,0"/>
                <TextBox Style="{StaticResource ValidatedTextBox}" Text="{Binding ConfirmPassword, UpdateSourceTrigger=LostFocus, ValidatesOnNotifyDataErrors=True, NotifyOnValidationError=True}" FontSize="16" Width="360"/>

                <Label Content="{x:Static language:Lang.profileOptionalName}" Style="{StaticResource normal}" Margin="0,16,0,0"/>
                <TextBox Style="{StaticResource ValidatedTextBox}" Text="{Binding FirstName, UpdateSourceTrigger=LostFocus, ValidatesOnNotifyDataErrors=True, NotifyOnValidationError=True}"/>
                <Label Content="{x:Static language:Lang.profileOptionalLastName}" Style="{StaticResource normal}" Margin="0,16,0,0"/>
                <TextBox Style="{StaticResource ValidatedTextBox}" Text="{Binding LastName, UpdateSourceTrigger=LostFocus, ValidatesOnNotifyDataErrors=True, NotifyOnValidationError=True}"/>

                <Button Content="{x:Static language:Lang.loginSignIn}" Style="{StaticResource buttonCustomFocus}" Margin="0,24,0,0" Height="45" Width="240" IsEnabled="{Binding CanSubmit}" Click="Click_SignIn"/>
                <Button Content="{x:Static language:Lang.globalCancel}" Style="{StaticResource buttonCustomFocus}" Margin="0,12,0,0" Height="45" Width="240" Click="Click_btnClose"/>
            </StackPanel>
        </Grid>

        <Rectangle x:Name="VerifyBackdrop" Fill="#80000000" Visibility="Collapsed" Panel.ZIndex="9" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" MouseLeftButtonUp="HideVerify_Click"/>
        <Grid x:Name="VerifyGrid" Width="640" Height="300" Background="#272727" Visibility="Collapsed" HorizontalAlignment="Center" VerticalAlignment="Center" Panel.ZIndex="10">
            <Grid.RenderTransform>
                <TranslateTransform Y="800"/>
            </Grid.RenderTransform>
            <Grid Margin="20">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Label Grid.Row="0" Content="{x:Static language:Lang.loginVerifyEmail}" Style="{StaticResource subtitle}" Foreground="White" HorizontalAlignment="Center" Margin="0,10,0,16"/>
                <StackPanel Grid.Row="1">
                    <TextBlock Text="{x:Static language:Lang.loginCode6DigitsSent}" Style="{StaticResource normal}"/>
                    <TextBlock x:Name="VerifyEmailLabel" Style="{StaticResource normal}" FontWeight="Bold" Margin="0,0,0,8"/>
                    <TextBlock Text="{x:Static language:Lang.loginVerificationCode}" Style="{StaticResource normal}"/>
                    <TextBox x:Name="VerifyCode" Style="{StaticResource textBoxCustomFocus}" Margin="0,2,0,8" Width="320" MaxLength="6"/>
                </StackPanel>
                <Grid Grid.Row="2" Margin="0,14,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Button Grid.Column="0" Content="{x:Static language:Lang.globalCancel}" Style="{StaticResource buttonCustomFocus}" Width="180" Height="40" Click="HideVerify_Click"/>
                    <Button Grid.Column="1" Content="{x:Static language:Lang.globalConfirm}" Style="{StaticResource buttonCustomFocus}" Width="180" Height="40" Click="ConfirmVerify_Click"/>
                </Grid>
            </Grid>
        </Grid>
    </Grid>
</UserControl>